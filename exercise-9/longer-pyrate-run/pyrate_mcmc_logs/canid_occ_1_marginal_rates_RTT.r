# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.185243874793, 0.185243874793,0.184460936543,0.184460936543,0.122719367286,0.0451841706962,0.0240706815008,0.0327656598448,0.0327281677595,0.0327281677595,0.0371576195296,0.0377784595533,0.0375240323317,0.0371576195296,0.0375240323317,0.0354877922513,0.0387675068054,0.053410311038,0.0912544510173,0.0936265278953,0.0963535511063,0.0971791662333,0.097245712783,0.0963827811133,0.0963827811133,0.097245712783,0.096560299827,0.0970428567543,0.0956100957826,0.0907248895321,0.0912768636483,0.101169608445,0.130338168386,0.146248243614,0.146564455631,0.146564455631,0.152400887173,0.151539186046,0.133543457333,0.13504786433,0.133502486443,0.130907450345,0.127811879077,0.120557251108,0.120557251108,0.107543619831,0.109821248849,0.110928159927,0.107543619831,0.107543619831)
L_hpd_M95=c(0.362109389803, 0.362109389803,0.360608704065,0.360608704065,0.363359339412,0.319487953508,0.200689965225,0.127340128531,0.126173280079,0.1257309997,0.127768429038,0.129112904799,0.129285087391,0.129677064413,0.131293046045,0.135625640047,0.164704179968,0.186589552404,0.195649998141,0.191822105679,0.193487098128,0.1930070568,0.1930070568,0.191823366908,0.1930070568,0.195649998141,0.195808923585,0.197977288171,0.197977288171,0.201092920939,0.275239138556,0.405933871304,0.428931440401,0.441793033497,0.440746950216,0.440746950216,0.448083094504,0.447801640188,0.434482958709,0.438901910669,0.439069627595,0.439451298945,0.439610082263,0.438901910669,0.447801640188,0.45063180901,0.470777925637,0.481897024479,0.492733973931,0.494048013823)
M_hpd_m95=c(0.830014362467, 0.830014362467,0.0898643140006,0.0898643140006,0.0898643140006,0.0872140987482,0.0833691118463,0.0747651211371,0.0754504610247,0.0754133046488,0.0770653174928,0.0770025073332,0.0770025073332,0.077201139337,0.0770025073332,0.077201139337,0.0773422841499,0.0773422841499,0.0773422841499,0.077201139337,0.0770025073332,0.0755186351545,0.0719636424362,0.067424013503,0.0583669081537,0.0533053722398,0.0498036876949,0.0495481254518,0.0467623236882,0.0461747872881,0.0454076058829,0.0444267561162,0.0444267561162,0.0441857616822,0.0374424160312,0.029299232454,0.0263164723805,0.0226361227478,0.0223555283364,0.0226361227478,0.0205523391334,0.0202319158149,0.0202319158149,0.0202319158149,0.0202319158149,0.0202319158149,0.0202319158149,0.0202319158149,0.0202319158149,0.0202319158149)
M_hpd_M95=c(1.44371447735, 1.44371447735,0.233964593905,0.233964593905,0.233964593905,0.231391872943,0.227108314491,0.186303560209,0.139349439162,0.135371110976,0.134525930259,0.133222263677,0.133109995199,0.133222263677,0.133109995199,0.133109995199,0.132952786282,0.133034591608,0.133034591608,0.133034591608,0.133222263677,0.133034591608,0.134782210498,0.133222263677,0.128321832869,0.124737697277,0.120070798261,0.119782402384,0.115911922383,0.114625817851,0.114625817851,0.114244638786,0.114625817851,0.118635888212,0.119337180793,0.120070798261,0.1226275646,0.119807663852,0.120440396248,0.122567909183,0.122754331455,0.124087009032,0.124087009032,0.124087009032,0.124087009032,0.124087009032,0.124087009032,0.124087009032,0.124087009032,0.124087009032)
R_hpd_m95=c(-1.21411622547, -1.21411622547,-0.00785057580083,-0.00573182481003,-0.0406927193933,-0.147243079926,-0.210380582516,-0.134012808346,-0.0872545841912,-0.0835059204429,-0.0814394076368,-0.079904045795,-0.079904045795,-0.079904045795,-0.079904045795,-0.079904045795,-0.0775465353942,-0.0610166207738,-0.0258950865749,-0.0187866501919,-0.017934416399,-0.015118134,-0.017934416399,-0.0184262829284,-0.0184262829284,-0.00908079374526,-0.0075757272754,-0.00287950983449,-0.00201867563623,-0.00201867563623,-0.00801689398608,0.010409520109,0.0420099216603,0.0521416466982,0.0488956264326,0.0542931423784,0.053289900359,0.0542931423784,0.0542931423784,0.053289900359,0.0546062355347,0.055740480588,0.031472209483,0.0300678294149,0.031472209483,0.0288337059553,0.0247186091014,0.00946003532137,0.0256584321363,0.0288337059553)
R_hpd_M95=c(-0.568795841947, -0.568795841947,0.218812933593,0.220641182962,0.227768806466,0.211217157839,0.0670278657865,0.0323555985784,0.0301608214135,0.0277524629927,0.0272553490993,0.0290832514209,0.028740426164,0.028938710491,0.0311675954168,0.0367975606538,0.0663831576152,0.0881343129638,0.0958282303294,0.0959879834503,0.0958282303294,0.0971135467789,0.0970600319516,0.100185311482,0.104694663864,0.115656289039,0.119854915742,0.125632962572,0.125632962572,0.13255420135,0.192019967823,0.327784413302,0.35724120424,0.365903293651,0.365214034054,0.371639504936,0.373590227526,0.370718621101,0.370718621101,0.376536836567,0.382736418792,0.387667454287,0.372582530174,0.377386883725,0.383156663791,0.394296637202,0.409149607229,0.409149607229,0.440973643091,0.446459427885)
L_mean=c(0.264396945947, 0.264396945947,0.264517737593,0.264484931809,0.255738833882,0.204921852079,0.0806174415671,0.0711481500522,0.07091557044,0.0709636004967,0.0719804284538,0.0725962380551,0.0729619488671,0.0730105591924,0.0735611298475,0.0755138396883,0.0919151379408,0.126406403256,0.144406648995,0.145972522523,0.146399321718,0.146638538456,0.146631326381,0.146853062001,0.147346526346,0.147875330169,0.148117572975,0.148435869227,0.148667833141,0.149890558243,0.160570352636,0.245523337785,0.287549783674,0.297976422244,0.302446302906,0.302914033708,0.303005930232,0.30185700667,0.299651857511,0.298766801694,0.298149203347,0.298051713448,0.295524635137,0.294925907988,0.295171979939,0.296522036056,0.299830244872,0.303268379337,0.306892564719,0.307234414802)
M_mean=c(1.13553580205, 1.13553580205,0.146040463616,0.146031636803,0.14599435568,0.144614076225,0.134138212763,0.115102270621,0.106404792684,0.105174669732,0.104927662558,0.10503830046,0.105054427552,0.105053042047,0.105071407375,0.104983125834,0.104924306448,0.104948551884,0.105033080868,0.10508110995,0.10497920737,0.104077579192,0.102117415855,0.099159519377,0.0959808540639,0.0914626419592,0.0884189807918,0.0857395790326,0.0835604033957,0.0823853470263,0.0813233269351,0.0810009101538,0.0808752543758,0.0813030397289,0.0793921834315,0.0776018256747,0.0765130279195,0.0765480399041,0.0766663262183,0.0767375052655,0.0767369733235,0.0769892095968,0.0769706574155,0.0769706574155,0.0769706574155,0.0769706574155,0.0769706574155,0.0769706574155,0.0769706574155,0.0769706574155)
R_mean=c(-0.871138856105, -0.871138856105,0.118477273976,0.118453295006,0.109744478202,0.0603077758547,-0.0535207711957,-0.0439541205686,-0.0354892222437,-0.034211069235,-0.0329472341039,-0.0324420624053,-0.032092478685,-0.032042482855,-0.0315102775274,-0.0294692861458,-0.013009168507,0.0214578513716,0.0393735681275,0.0408914125725,0.0414201143484,0.0425609592635,0.0445139105263,0.0476935426239,0.0513656722819,0.0564126882101,0.0596985921829,0.0626962901949,0.0651074297457,0.0675052112169,0.0792470257004,0.164522427631,0.206674529299,0.216673382515,0.223054119474,0.225312208034,0.226492902312,0.225308966766,0.222985531292,0.222029296429,0.221412230024,0.221062503851,0.218553977721,0.217955250573,0.218201322523,0.21955137864,0.222859587456,0.226297721921,0.229921907304,0.230263757386)
trans=0.5
age=(0:(50-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.543452815205), xlim = c(-52.5,2.5), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.58808592509), xlim = c(-52.5,2.5), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.33552784802, 0.491105370674), xlim = c(-52.5,2.5), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-52.5,2.5), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()