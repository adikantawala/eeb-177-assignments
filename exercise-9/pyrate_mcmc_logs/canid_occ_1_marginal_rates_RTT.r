# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.143241936145, 0.143241936145,0.143241936145,0.143241936145,0.143241936145,0.0711219310013,0.0537892217657,0.0469910874894,0.0447667356454,0.0447667356454,0.0447667356454,0.0447667356454,0.0508972585637,0.0508972585637,0.0508972585637,0.0508972585637,0.05586416552,0.0521258417182,0.0521258417182,0.0591966014094,0.06975430877,0.0962247996091,0.0967112563844,0.0967112563844,0.102374333672,0.0982110690599,0.102374333672,0.0982110690599,0.0909597509471,0.0992015172895,0.105546800635,0.146134519667,0.143241936145,0.149077234739,0.150359503949,0.150359503949,0.143241936145,0.143241936145,0.143241936145,0.143241936145,0.143241936145,0.143241936145,0.143241936145,0.111905500346,0.106927425101,0.111905500346,0.111905500346,0.111905500346,0.111905500346)
L_hpd_M95=c(0.318428206414, 0.318428206414,0.318428206414,0.320317228842,0.331936939842,0.314144388067,0.265673275581,0.156389494439,0.136990984665,0.131850130104,0.131850130104,0.131850130104,0.136990984665,0.136990984665,0.136990984665,0.14353484657,0.150704998822,0.151693257401,0.156389494439,0.183382572374,0.204581331118,0.224604169542,0.222062361578,0.222062361578,0.224604169542,0.222062361578,0.224604169542,0.222062361578,0.222062361578,0.240319725902,0.332660827767,0.402963341429,0.402963341429,0.400560146727,0.414868402757,0.414868402757,0.4007547852,0.402963341429,0.414868402757,0.441043651632,0.441043651632,0.441043651632,0.453912959446,0.44379672018,0.44379672018,0.453912959446,0.453912959446,0.453912959446,0.453912959446)
M_hpd_m95=c(0.846579710723, 0.846579710723,0.0881751242015,0.0881751242015,0.0881751242015,0.0881751242015,0.0811075294559,0.0895956857187,0.0895956857187,0.0903812971789,0.0895956857187,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0871720844213,0.0811075294559,0.0707985436516,0.061702662751,0.0616947116866,0.0537112637404,0.0537112637404,0.0489664686531,0.0397435140801,0.0397435140801,0.0391253179004,0.0389809329487,0.0389809329487,0.0389809329487,0.0389809329487,0.0389809329487,0.0389809329487,0.0389809329487,0.0389809329487,0.0389809329487,0.0292809283105,0.0292809283105,0.0292809283105,0.0292809283105,0.0292809283105,0.0292809283105)
M_hpd_M95=c(1.44766474926, 1.44766474926,0.195871576223,0.195871576223,0.195871576223,0.195871576223,0.182915688099,0.137971786332,0.136853237129,0.136853237129,0.136853237129,0.133006845992,0.133006845992,0.133006845992,0.133006845992,0.133006845992,0.133006845992,0.133006845992,0.133006845992,0.133006845992,0.133006845992,0.132739743846,0.132739743846,0.133006845992,0.137971786332,0.140570451486,0.132739743846,0.132739743846,0.131152372069,0.131152372069,0.132739743846,0.125201931279,0.129910438322,0.129910438322,0.129910438322,0.129910438322,0.129284751542,0.129284751542,0.129284751542,0.129284751542,0.129284751542,0.129284751542,0.129910438322,0.13398921315,0.13398921315,0.13960892354,0.13960892354,0.13960892354,0.13960892354)
R_hpd_m95=c(-1.16228848845, -1.16228848845,0.00767532355948,0.00767532355948,0.00267148465899,-0.0577321815666,-0.0979376704749,-0.0792214495926,-0.0792214495926,-0.0714127095137,-0.0714127095137,-0.0714127095137,-0.0755541872363,-0.0755541872363,-0.0662876140594,-0.0714127095137,-0.0792214495926,-0.0607780816737,-0.0607780816737,-0.0564498266117,-0.0433228698257,-0.0265512611436,-0.0224573853829,-0.0224573853829,-0.0265512611436,-0.0213228574283,-0.0199431923845,-0.0062943241608,-0.00758951478449,-0.0062943241608,-0.000889944029953,0.0436967826878,0.0397109713359,0.0506944153075,0.045946339174,0.045946339174,0.045946339174,0.045946339174,0.045946339174,0.045946339174,0.045946339174,0.0198568528335,0.0323717421082,0.0198568528335,-0.0271746696976,-0.0178825646324,-0.0178825646324,-0.0178825646324,-0.0178825646324)
R_hpd_M95=c(-0.575762101828, -0.575762101828,0.20819815548,0.208605068299,0.208605068299,0.208605068299,0.179013832067,0.0568309439916,0.0253809274493,0.0253809274493,0.0253809274493,0.0253809274493,0.0253809274493,0.0253809274493,0.0333174048289,0.0370831055939,0.0370831055939,0.0568309439916,0.0587289039099,0.0849667664479,0.108945602553,0.108945602553,0.110876686489,0.112773785262,0.112773785262,0.119797120923,0.119797120923,0.13246667586,0.146305750217,0.154602809789,0.259613047018,0.321018951641,0.32852267338,0.321018951641,0.340571570827,0.340571570827,0.334474700524,0.340571570827,0.361434828827,0.382674481663,0.382674481663,0.361434828827,0.390232520344,0.439135088414,0.406015754254,0.439135088414,0.439135088414,0.439135088414,0.439135088414)
L_mean=c(0.249530795558, 0.249530795558,0.249530795558,0.250148920438,0.250475249338,0.223394216931,0.120340762517,0.0895491818531,0.0860337200648,0.0854862622157,0.0854024782748,0.0854024782748,0.0861236444218,0.0861236444218,0.0871740100638,0.0883961192428,0.0894677817896,0.0919367499345,0.0949168933375,0.121996919188,0.14262112606,0.161580239481,0.162394787706,0.163050405156,0.163693063275,0.164402104261,0.164242903412,0.164590909617,0.165438193764,0.168076699219,0.199819193454,0.256445061892,0.267643598671,0.272804195254,0.279992121,0.280786163634,0.279063392526,0.27735995517,0.277854151162,0.279210218823,0.279185595425,0.280262074813,0.284626294454,0.288508502541,0.288549496165,0.290046009204,0.29367928602,0.29370318019,0.29370318019)
M_mean=c(1.1478870311, 1.1478870311,0.124919641703,0.124878272654,0.124878272654,0.123874632171,0.120473826876,0.113247534152,0.112459384115,0.112260086416,0.112198989811,0.112300440975,0.112300440975,0.112300440975,0.112300440975,0.112300440975,0.112300440975,0.112265872398,0.112265872398,0.112265872398,0.112265872398,0.112118501783,0.112118501783,0.111921240357,0.109920517141,0.108603495342,0.107281550391,0.105963943839,0.100844398438,0.095827415357,0.0930408126061,0.0865479057642,0.0846323166603,0.0820360330456,0.0811207662258,0.0811207662258,0.0806797333527,0.0806797333527,0.0805058710811,0.0805058710811,0.0805058710811,0.0805058710811,0.081483795122,0.087002441621,0.087002441621,0.0882033298564,0.0882033298564,0.0882033298564,0.0882033298564)
R_mean=c(-0.898356235545, -0.898356235545,0.124611153854,0.125270647784,0.125596976684,0.09951958476,-0.000133064358955,-0.0236983522986,-0.0264256640506,-0.0267738242007,-0.0267965115358,-0.0268979627006,-0.0261767965536,-0.0261767965536,-0.0251264309116,-0.0239043217327,-0.0228326591859,-0.0203291224634,-0.0173489790605,0.00973104679002,0.0303552536618,0.049461737698,0.0502762859225,0.0511291647986,0.0537725461334,0.0557986089195,0.0569613530207,0.058626965778,0.0645937953259,0.0722492838623,0.106778380848,0.169897156127,0.183011282011,0.190768162209,0.198871354774,0.199665397408,0.198383659173,0.196680221817,0.197348280081,0.198704347741,0.198679724344,0.199756203732,0.203142499332,0.20150606092,0.201547054544,0.201842679348,0.205475956163,0.205499850333,0.205499850333)
trans=0.5
age=(0:(49-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.49930425539), xlim = c(-51.45,2.45), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.59243122418), xlim = c(-51.45,2.45), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.27851733729, 0.483048597255), xlim = c(-51.45,2.45), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-51.45,2.45), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()